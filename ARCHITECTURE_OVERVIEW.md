# Integration Summary - Visual Overview\n\n## System Architecture\n\n```\n┌─────────────────────────────────────────────────────────────┐\n│                     User Browser                            │\n│                   localhost:3000                            │\n└────────────────────────┬────────────────────────────────────┘\n                         │\n                         │ HTTP/FETCH\n                         │\n        ┌────────────────┴────────────────┐\n        │                                 │\n   ┌────▼─────────────────┐      ┌─────▼──────────────┐\n   │  Next.js Frontend    │      │  Analysis Results  │\n   │  Components:         │      │  & Display         │\n   │  - Home Page         │      │                    │\n   │  - Sessions List     │      │  Page Updates with │\n   │  - File Upload       │      │  Analysis Metrics  │\n   │  - Analysis Results  │      │                    │\n   └────────┬──────────────┘      └────────────────────┘\n            │\n            │ API Calls via\n            │ api-client.ts\n            │\n   ┌────────▼──────────────────────────────────┐\n   │  Backend API - FastAPI                    │\n   │  localhost:8000                           │\n   │                                           │\n   │  POST /analyze                            │\n   │  ├─ Receives: file + metadata             │\n   │  ├─ Processes: Librosa/SciPy              │\n   │  └─ Returns: Analysis Features            │\n   │                                           │\n   │  GET /sessions                            │\n   │  └─ Returns: List of Sessions             │\n   └────────┬──────────────────────────────────┘\n            │\n            │ Audio Processing\n            │\n   ┌────────▼──────────────────────────────────┐\n   │  Librosa & SciPy Libraries                │\n   │  - Pitch Tracking (YIN)                   │\n   │  - Onset Detection                        │\n   │  - Tempo Extraction                       │\n   │  - Feature Extraction                     │\n   └────────┬──────────────────────────────────┘\n            │\n            │ Extracted Features\n            │\n   ┌────────▼──────────────────────────────────┐\n   │  Analysis Results                         │\n   │  ├─ BPM                                   │\n   │  ├─ Timing Accuracy                       │\n   │  ├─ Timing Stability                      │\n   │  ├─ Pitch Stability                       │\n   │  ├─ Pitch Deviation                       │\n   │  ├─ Sustain                               │\n   │  └─ Note Count                            │\n   └────────┬──────────────────────────────────┘\n            │\n            │ Webhook\n            │\n   ┌────────▼──────────────────────────────────┐\n   │  n8n Webhook                              │\n   │  (Session Storage & Processing)           │\n   └───────────────────────────────────────────┘\n```\n\n## Data Flow - Upload Scenario\n\n```\n┌─────────┐\n│ User    │\n└────┬────┘\n     │\n     │ 1. Create Session\n     ↓\n┌─────────────────────────────────────────┐\n│ Home Page (app/page.tsx)                │\n│ - Session Form                          │\n│ - Creates local session                 │\n└────────────────┬────────────────────────┘\n                 │\n                 │ 2. Navigate to Session\n                 ↓\n┌─────────────────────────────────────────┐\n│ Session Detail Page                     │\n│ (/sessions/[id]/page.tsx)               │\n│ - Display session info                  │\n│ - Show file upload component            │\n└────────────────┬────────────────────────┘\n                 │\n                 │ 3. Upload File\n                 ↓\n┌─────────────────────────────────────────┐\n│ FileUpload Component                    │\n│ - Drag & drop or click to select        │\n│ - Validates file type (WAV/MP3)         │\n│ - Shows upload progress                 │\n└────────────────┬────────────────────────┘\n                 │\n                 │ 4. Call uploadAudioFile()\n                 ↓\n┌─────────────────────────────────────────┐\n│ API Client (lib/api-client.ts)          │\n│ - uploadAudioFile() function            │\n│ - Creates FormData with file + metadata │\n│ - POST to /analyze endpoint             │\n└────────────────┬────────────────────────┘\n                 │ MULTIPART/FORM-DATA\n                 │ - file: [WAV/MP3]\n                 │ - session_name: \"...\"\n                 │ - session_date: \"...\"\n                 │ - session_notes: \"...\"\n                 │\n                 ↓\n┌─────────────────────────────────────────┐\n│ Backend (main.py)                       │\n│ POST /analyze                           │\n│ - Receive file & metadata               │\n│ - Load audio with librosa               │\n│ - Extract features                      │\n└────────────────┬────────────────────────┘\n                 │\n                 │ 5. Process Audio\n                 ↓\n┌─────────────────────────────────────────┐\n│ Feature Extraction                      │\n│ - compute_pitch_track()                 │\n│ - compute_sustain()                     │\n│ - compute_pitch_per_note()              │\n│ - compute_timing_accuracy()             │\n│ - compute_timing_stability()            │\n└────────────────┬────────────────────────┘\n                 │\n                 │ 6. Send Webhook\n                 ↓\n┌─────────────────────────────────────────┐\n│ n8n Webhook                             │\n│ (Send features for storage)             │\n└────────────────┬────────────────────────┘\n                 │\n                 │ 7. Return Response\n                 ↓\n┌─────────────────────────────────────────┐\n│ HTTP Response (200 OK)                  │\n│ {                                       │\n│   \"status\": \"analysis_complete\",        │\n│   \"sent\": {                             │\n│     \"features\": {                       │\n│       \"bpm\": 120,                       │\n│       \"timing_accuracy\": 0.94,          │\n│       ...                               │\n│     }                                   │\n│   }                                     │\n│ }                                       │\n└────────────────┬────────────────────────┘\n                 │\n                 │ 8. Update UI\n                 ↓\n┌─────────────────────────────────────────┐\n│ Session Detail Page                     │\n│ - Extract features from response        │\n│ - Update session state                  │\n│ - Save to sessionStorage                │\n└────────────────┬────────────────────────┘\n                 │\n                 │ 9. Render Results\n                 ↓\n┌─────────────────────────────────────────┐\n│ AnalysisResults Component               │\n│ - Display metrics in cards              │\n│ - Show progress bars                    │\n│ - Render metric values                  │\n│                                         │\n│ Metrics Displayed:                      │\n│ ├─ BPM: 120                             │\n│ ├─ Timing Accuracy: 94%                 │\n│ ├─ Timing Stability: 92%                │\n│ ├─ Pitch Stability: 88%                 │\n│ ├─ Pitch Deviation: 2.5¢                │\n│ ├─ Sustain: 0.0456                      │\n│ └─ Note Count: 24                       │\n└─────────────────────────────────────────┘\n```\n\n## Data Flow - View Sessions Scenario\n\n```\n┌─────────┐\n│ User    │\n└────┬────┘\n     │\n     │ Open Home Page\n     ↓\n┌────────────────────────────────────────────┐\n│ Home Page (app/page.tsx)                   │\n│ - useEffect hook triggered                 │\n│ - Call loadSessions()                      │\n└────────────┬────────────────────────────────┘\n             │\n             │ Call fetchSessions()\n             ↓\n┌────────────────────────────────────────────┐\n│ API Client (lib/api-client.ts)             │\n│ - fetchSessions() function                 │\n│ - GET /sessions                            │\n└────────────┬────────────────────────────────┘\n             │ GET REQUEST\n             ↓\n┌────────────────────────────────────────────┐\n│ Backend (main.py)                          │\n│ GET /sessions                              │\n│ - Query session data from n8n             │\n│ - Format response                          │\n└────────────┬────────────────────────────────┘\n             │\n             │ 1. Get Sessions (from n8n)\n             ↓\n┌────────────────────────────────────────────┐\n│ n8n Database/Storage                       │\n│ - Retrieve stored sessions                 │\n│ - Return with features                     │\n└────────────┬────────────────────────────────┘\n             │\n             │ 2. Return Response\n             ↓\n┌────────────────────────────────────────────┐\n│ HTTP Response (200 OK)                     │\n│ {                                          │\n│   \"sessions\": [                            │\n│     {                                      │\n│       \"id\": \"1\",                           │\n│       \"session_name\": \"Jazz Solo\",         │\n│       \"session_date\": \"2025-11-18\",        │\n│       \"features\": {...}                    │\n│     },                                     │\n│     {...}                                  │\n│   ]                                        │\n│ }                                          │\n└────────────┬────────────────────────────────┘\n             │\n             │ 3. Map Response\n             ↓\n┌────────────────────────────────────────────┐\n│ loadSessions() in Home Page                │\n│ - Map API response to Session[]            │\n│ - Update setSessions()                     │\n└────────────┬────────────────────────────────┘\n             │\n             │ 4. Render Sessions\n             ↓\n┌────────────────────────────────────────────┐\n│ SessionsList Component                     │\n│ - Display sessions in grid                 │\n│ - Each session as Card                     │\n│ - Show metrics (BPM, accuracy, etc)        │\n│                                            │\n│ Card Contents:                             │\n│ ├─ Session Name                            │\n│ ├─ Session Date                            │\n│ ├─ Created When                            │\n│ ├─ Status Badge                            │\n│ ├─ Notes                                   │\n│ └─ View Session Button                     │\n└────────────────────────────────────────────┘\n```\n\n## Component Integration Map\n\n```\n┌──────────────────────────────────────────────────────────────┐\n│ App Layout                                                   │\n│ ├─ Header (Global Navigation)                               │\n│ │  └─ Logo, Navigation Links                                │\n│ │                                                            │\n│ ├─ Routes                                                    │\n│ │  ├─ / (Home Page)                                          │\n│ │  │  ├─ useState: sessions, formData, loading              │\n│ │  │  ├─ useEffect: loadSessions() on mount                │\n│ │  │  ├─ renders: Create Session Form                       │\n│ │  │  └─ renders: SessionsList Component                    │\n│ │  │     └─ calls: fetchSessions()                          │\n│ │  │                                                         │\n│ │  └─ /sessions/[id] (Session Detail)                       │\n│ │     ├─ useState: session, uploading                       │\n│ │     ├─ useEffect: Load session from storage               │\n│ │     ├─ renders: Session Info Card                         │\n│ │     ├─ renders: FileUpload Component                      │\n│ │     │  └─ onUpload: calls handleFileUpload()              │\n│ │     │     └─ calls: uploadAudioFile()                     │\n│ │     │        └─ POST /analyze                             │\n│ │     └─ renders: AnalysisResults Component                 │\n│ │        └─ displays: Analysis metrics                      │\n│ │                                                            │\n│ └─ API Client (lib/api-client.ts)                           │\n│    ├─ uploadAudioFile(file, ...)                            │\n│    │  └─ POST /analyze (Backend)                            │\n│    ├─ fetchSessions()                                       │\n│    │  └─ GET /sessions (Backend)                            │\n│    └─ apiCall(endpoint, options)                            │\n│       └─ Generic API caller with auth                       │\n│                                                              │\n└──────────────────────────────────────────────────────────────┘\n```\n\n## Technologies Used\n\n### Frontend Stack\n```\nNext.js 14+           (React Framework)\n├─ TypeScript          (Type Safety)\n├─ React Hooks         (State Management)\n├─ date-fns            (Date Formatting)\n└─ Custom UI Components (Shadcn-style)\n```\n\n### Backend Stack\n```\nFastAPI               (Web Framework)\n├─ Python 3.8+        (Language)\n├─ Librosa            (Audio Processing)\n├─ NumPy              (Numerical Computing)\n├─ SciPy              (Scientific Computing)\n├─ httpx              (HTTP Client)\n└─ Uvicorn            (ASGI Server)\n```\n\n### Integration\n```\nHTTP/REST            (Communication)\n├─ Multipart Form-Data (File Upload)\n├─ JSON               (Data Exchange)\n└─ CORS               (Cross-Origin)\n```\n\n## Environment Variables\n\n```\nFrontend (.env.local)\n├─ NEXT_PUBLIC_BACKEND_URL\n│  └─ Default: http://localhost:8000\n│  └─ Purpose: Backend API Base URL\n│\nBackend (.env)\n├─ N8N_WEBHOOK_URL\n   └─ Default: https://xavas.app.n8n.cloud/webhook-test/guitar-analyser\n   └─ Purpose: n8n Webhook for Session Storage\n```\n\n## Status: ✅ Complete\n\nAll components are properly integrated and ready for development/testing.\n"